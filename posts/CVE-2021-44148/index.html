<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="CVE-2021-44148 How I accidentally got my 4th CVE" /><meta property="og:locale" content="en" /><meta name="description" content="I accidentally got my 4th CVE. CVE ID: CVE-2021-44148" /><meta property="og:description" content="I accidentally got my 4th CVE. CVE ID: CVE-2021-44148" /><link rel="canonical" href="https://beauknows.tech/posts/CVE-2021-44148/" /><meta property="og:url" content="https://beauknows.tech/posts/CVE-2021-44148/" /><meta property="og:site_name" content="Beau Knows Tech" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-30T11:20:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CVE-2021-44148 How I accidentally got my 4th CVE" /><meta name="twitter:site" content="@beauknowstech" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-11-30T11:20:00-07:00","datePublished":"2021-11-30T11:20:00-07:00","description":"I accidentally got my 4th CVE. CVE ID: CVE-2021-44148","headline":"CVE-2021-44148 How I accidentally got my 4th CVE","mainEntityOfPage":{"@type":"WebPage","@id":"https://beauknows.tech/posts/CVE-2021-44148/"},"url":"https://beauknows.tech/posts/CVE-2021-44148/"}</script><title>CVE-2021-44148 How I accidentally got my 4th CVE | Beau Knows Tech</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Beau Knows Tech"><meta name="application-name" content="Beau Knows Tech"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://pbs.twimg.com/profile_images/1534266752837726208/qOVJxJZd_400x400.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Beau Knows Tech</a></div><div class="site-subtitle font-italic">The best defense is a good offense. Or something</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/beauknowstech" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/beauknowstech" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/beaugraham/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>CVE-2021-44148 How I accidentally got my 4th CVE</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>CVE-2021-44148 How I accidentally got my 4th CVE</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/beauknowstech">Beau Graham</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1638296400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2021-11-30 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="660 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h1 id="i-accidentally-got-my-4th-cve">I accidentally got my 4th CVE.</h1><h2 id="cve-id-cve-2021-44148"><span class="mr-2">CVE ID: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44148"><span class="mr-2">CVE-2021-44148</a></span><a href="#cve-id-cve-2021-44148" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Don’t get too excited, it’s just an XSS. Just a standard XSS.</p><p>I’m about to go full recipe blog:</p><p>The story of this CVE begins in 2014 when I first heard of the wifi pineapple from Hak5. At the time, I was working in IT making 30k a year and paying for my ex-wife to go to college. I did not have $100 bucks or whatever it was to drop on a wifi-pineapple. In 2016 I saw blog articles like these:</p><p><a href="http://sapinski.com/2016/02/13/wifi-pineapple-firmware-for-gl-inet-gl-ar150/">http://sapinski.com/2016/02/13/wifi-pineapple-firmware-for-gl-inet-gl-ar150/</a></p><p><a href="https://www.securityaddicted.com/2016/11/17/weaponizing-gl-inet-gl-ar150/">https://www.securityaddicted.com/2016/11/17/weaponizing-gl-inet-gl-ar150/</a></p><p><a href="https://jerrygamblin.com/2016/04/11/turning-a-25-gl-ar150-into-a-100-wifipineapple/?platform=hootsuite">https://jerrygamblin.com/2016/04/11/turning-a-25-gl-ar150-into-a-100-wifipineapple/?platform=hootsuite</a></p><p>All claiming you could buy a $25 mini router and turn it into a wifi pineapple. I instantly bought one.</p><p><img data-src="/assets/img/order.png" alt="order" data-proofer-ignore></p><p>But because of my 2x diagnosed ADHD/ADD I never even got as far as installing the wifi pineapple firmware. It had taken about a week to get to my house and by that time I had become obsessed with something else.</p><h2 id="fast-forward-to-2019"><span class="mr-2">Fast forward to 2019.</span><a href="#fast-forward-to-2019" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I started working as a pentester in July-ish of 2019. Specifically working on web application pentests. At this time whenever I see something on Twitter or LinkedIn about something web-app pentest or bug bounty related, I read it. I came across this blog post:</p><p><a href="https://infosecwriteups.com/5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968">https://infosecwriteups.com/5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968</a></p><p>Reading this made me realize that literally any input could be an XSS and I thought to myself I may as well make an XSS SSID just in case for the future. I have Ubiquiti equipment at home so it was easy enough to create an SSID called <code class="language-plaintext highlighter-rouge">&lt;script&gt;alert(2)&lt;script&gt;</code>. Keep in mind that SSID’s have to be less than 32 characters.</p><p><img data-src="/assets/img/scriptwifi.png" alt="wifi" data-proofer-ignore></p><h2 id="fast-forward-again-to-late-2021"><span class="mr-2">Fast forward again to late 2021.</span><a href="#fast-forward-again-to-late-2021" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The pandemic has been “almost over” for a year now.</p><p>People are starting to go back into the office. I can’t really talk about what I was working on but for a pentest I needed a little router. I remembered back when I bought my GL-AR150 in 2016. I had since moved 5 times. In my last move I decided to index everything that was in each box so I found it relatively fast.</p><p>I plugged it in and connected to the default network it provided. After setting a root password, I logged in and started navigating around the menus to see if anything would be helpful for my pentest or if I should just install default openwrt.</p><p><img data-src="/assets/img/alert.png" alt="alert" data-proofer-ignore></p><p>Seemingly out of nowhere I get this popup. For about 4 seconds I was like “WUT….” and then it all clicked. I was on the repeater page where it searches for wifi networks. My SSID that I had made in 2019 finally did something.</p><p>At this point I just started laughing. I couldn’t believe it. My wife thought something was wrong because of the noises that were coming out of my home office.</p><p>I didn’t have time to create a real XSS payload like I normally do but I still felt good about finding this one. I decided to take it just one step further using xsshunter.com.</p><p>As you remember an SSID can only be 32 characters. So my normal xsshunter payloads weren’t going to work. So instead I followed this blog post and created a short domain that forwarded to my normal xsshunter payload page:</p><p><a href="https://medium.com/@mohameddaher/how-i-paid-2-for-1054-xss-bug-20-chars-blind-xss-payloads-12d32760897b">https://medium.com/@mohameddaher/how-i-paid-2-for-1054-xss-bug-20-chars-blind-xss-payloads-12d32760897b</a></p><p>So now I have an SSID that has my xsshunter payload in it just in case this happens again. So now I’ll get notifications:</p><p><img data-src="/assets/img/notification.png" alt="email" data-proofer-ignore></p><p>Something else to remember is that this was purchased in 2016. It had an extremely old firmware on it. So when I found this bug it was running on firmware version 2.19 and the bug was fixed in version 3 of the firmware. The current version as of writing is 3.203. More can be found here:</p><p><a href="https://docs.gl-inet.com/en/3/release_notes/">https://docs.gl-inet.com/en/3/release_notes/</a></p><h2 id="tldr"><span class="mr-2">TL;DR</span><a href="#tldr" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>XSS payload as WiFi SSID leads to reflected XSS.</p><p>Timeline:</p><ul><li>Nov 16th 2021 Found bug<li>Nov 17th 2021 Notified company of bug via email<li>Bug has already been fixed in version 3.x of firmware.<li>Nov 20th submit for CVE<li>Nov 22nd CVE reserved</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cve-2021-44148/'>CVE-2021-44148</a>, <a href='/categories/cve/'>CVE</a>, <a href='/categories/xss/'>XSS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/xss/" class="post-tag no-text-decoration" >xss</a> <a href="/tags/cve/" class="post-tag no-text-decoration" >cve</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=CVE-2021-44148 How I accidentally got my 4th CVE - Beau Knows Tech&amp;url=https://beauknows.tech/posts/CVE-2021-44148/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=CVE-2021-44148 How I accidentally got my 4th CVE - Beau Knows Tech&amp;u=https://beauknows.tech/posts/CVE-2021-44148/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://beauknows.tech/posts/CVE-2021-44148/&amp;text=CVE-2021-44148 How I accidentally got my 4th CVE - Beau Knows Tech" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/I-Passed-the-OSCP/">I passed the OSCP with 100 points</a><li><a href="/posts/UAC-bypass/">UAC bypass - why and how</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/burp-suite/">burp suite</a> <a class="post-tag" href="/tags/collaborator/">collaborator</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/interact-sh/">interact.sh</a> <a class="post-tag" href="/tags/oscp/">oscp</a> <a class="post-tag" href="/tags/oscp/">OSCP</a> <a class="post-tag" href="/tags/uac-bypass/">uac bypass</a> <a class="post-tag" href="/tags/xss/">xss</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/I-Passed-the-OSCP/"><div class="card-body"> <em class="timeago small" data-ts="1656706920" > 2022-07-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>I passed the OSCP with 100 points</h3><div class="text-muted small"><p> I passed the OSCP with 100 points w/o lab report. Youtube Version This post and video share parts from eachother. Whoami My name is Beau and I am a web app pentester for a company. And recently ...</p></div></div></a></div><div class="card"> <a href="/posts/collaborator-alternatives/"><div class="card-body"> <em class="timeago small" data-ts="1654636800" > 2022-06-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Free Burp Collaborator Alternatives</h3><div class="text-muted small"><p> Free Burp Collaborator Alternatives The best one that you don’t have to host yourself is interact.sh by far. But I’ve seen that domain get blocked before on outbound traffic from targets. So you m...</p></div></div></a></div><div class="card"> <a href="/posts/UAC-bypass/"><div class="card-body"> <em class="timeago small" data-ts="1654453200" > 2022-06-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>UAC bypass - why and how</h3><div class="text-muted small"><p> UAC bypass - why and how As a hacker sometimes you will land on a windows machine as a user that has admin rights, but anything you try and do that will require admin rights will (mimikatz anyone?...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/UAC-bypass/" class="btn btn-outline-primary" prompt="Newer"><p>UAC bypass - why and how</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/beauknowstech">Beau Graham</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/burp-suite/">burp suite</a> <a class="post-tag" href="/tags/collaborator/">collaborator</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/interact-sh/">interact.sh</a> <a class="post-tag" href="/tags/oscp/">oscp</a> <a class="post-tag" href="/tags/oscp/">OSCP</a> <a class="post-tag" href="/tags/uac-bypass/">uac bypass</a> <a class="post-tag" href="/tags/xss/">xss</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-V7P1B2M37C"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-V7P1B2M37C'); }); </script>
